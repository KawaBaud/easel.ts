(function(z,W){typeof exports=="object"&&typeof module<"u"?W(exports):typeof define=="function"&&define.amd?define(["exports"],W):(z=typeof globalThis<"u"?globalThis:z||self,W(z.easel={}))})(this,function(z){"use strict";const W="1dev",ft=1.5707963267948966,Jt=57.29577951308232,Kt=.017453292519943295,f={clamp(u,t,s){return u<t?t:u>s?s:u},fastAtan2(u,t){if(t===0)return u===0?0:u>0?ft:-ft;if(u===0)return t>=0?0:Math.PI;const s=Math.abs(u),e=Math.abs(t),i=s<=e,n=i?s/e:e/s,r=n*n;let o=(((-.046496*r+.15931)*r-.32763)*r+1)*n;return o=i?o:ft-o,o=t<0?Math.PI-o:o,u<0?-o:o},fastMax(u,t){return u>t?u:t},fastMin(u,t){return u<t?u:t},fastRound(u){return u+.5|0},fastTrunc(u){return u|0},isPowerOf2(u){return u>0&&(u&u-1)===0},nextPowerOf2(u){let t=u;return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t++,t},safeAsin(u){return Math.asin(u<-1?-1:u>1?1:u)},toDegrees(u){return u*Jt},toRadians(u){return u*Kt}};class k{#t=0;#s=0;#e=0;#i=1;constructor(t=0,s=0,e=0,i=1){this.#t=t,this.#s=s,this.#e=e,this.#i=i}get x(){return this.#t}set x(t){this.#t=t}get y(){return this.#s}set y(t){this.#s=t}get z(){return this.#e}set z(t){this.#e=t}get w(){return this.#i}set w(t){this.#i=t}get length(){return Math.sqrt(this.lengthSq)}get lengthSq(){const{x:t,y:s,z:e,w:i}=this;return t*t+s*s+e*e+i*i}clone(){return new k().copy(this)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this}divScalar(t){return this.x/=t,this.y/=t,this.z/=t,this.w/=t,this}fromArray(t){return this.x=t[0],this.y=t[1],this.z=t[2],this.w=t[3],this}invert(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}premul(t){const{x:s,y:e,z:i,w:n}=this,{x:r,y:o,z:h,w:c}=t;return this.x=r*n+c*s+o*i-h*e,this.y=o*n+c*e+h*s-r*i,this.z=h*n+c*i+r*e-o*s,this.w=c*n-r*s-o*e-h*i,this}set(t,s,e,i){return this.x=t,this.y=s,this.z=e,this.w=i,this}setFromAxisAngle(t,s){const e=s/2,i=Math.sin(e);return this.x=t.x*i,this.y=t.y*i,this.z=t.z*i,this.w=Math.cos(e),this}setFromEuler(t){const{x:s,y:e,z:i,order:n}=t,r=Math.cos(s/2),o=Math.cos(e/2),h=Math.cos(i/2),c=Math.sin(s/2),a=Math.sin(e/2),l=Math.sin(i/2);switch(n){case"XYZ":return this.x=c*o*h+r*a*l,this.y=r*a*h-c*o*l,this.z=r*o*l+c*a*h,this.w=r*o*h-c*a*l,this;case"YXZ":return this.x=c*o*h+r*a*l,this.y=r*a*h-c*o*l,this.z=r*o*l-c*a*h,this.w=r*o*h+c*a*l,this;case"ZXY":return this.x=c*o*h-r*a*l,this.y=r*a*h+c*o*l,this.z=r*o*l+c*a*h,this.w=r*o*h-c*a*l,this;case"ZYX":return this.x=c*o*h-r*a*l,this.y=r*a*h+c*o*l,this.z=r*o*l-c*a*h,this.w=r*o*h+c*a*l,this;case"YZX":return this.x=c*o*h+r*a*l,this.y=r*a*h+c*o*l,this.z=r*o*l-c*a*h,this.w=r*o*h-c*a*l,this;case"XZY":return this.x=c*o*h-r*a*l,this.y=r*a*h-c*o*l,this.z=r*o*l+c*a*h,this.w=r*o*h+c*a*l,this;default:throw new Error(`Easel.Quaternion: unknown Euler order: ${n}`)}}setFromRotationMatrix(t){const s=t.elements,e=s[0],i=s[4],n=s[8],r=s[1],o=s[5],h=s[9],c=s[2],a=s[6],l=s[10],y=e+o+l;if(y>0){const d=.5/Math.sqrt(y+1);this.w=.25/d,this.x=(a-h)*d,this.y=(n-c)*d,this.z=(r-i)*d}else if(e>o&&e>l){const d=2*Math.sqrt(1+e-o-l);this.w=(a-h)/d,this.x=.25*d,this.y=(i+r)/d,this.z=(n+c)/d}else if(o>l){const d=2*Math.sqrt(1+o-e-l);this.w=(n-c)/d,this.x=(i+r)/d,this.y=.25*d,this.z=(h+a)/d}else{const d=2*Math.sqrt(1+l-e-o);this.w=(r-i)/d,this.x=(n+c)/d,this.y=(h+a)/d,this.z=.25*d}return this}unitize(){return this.divScalar(this.length||1)}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}const It=new k;class p{#t=0;#s=0;#e=0;constructor(t=0,s=0,e=0){this.#t=t,this.#s=s,this.#e=e}get x(){return this.#t}set x(t){this.#t=t}get y(){return this.#s}set y(t){this.#s=t}get z(){return this.#e}set z(t){this.#e=t}get length(){return Math.sqrt(this.lengthSq)}get lengthSq(){const{x:t,y:s,z:e}=this;return t*t+s*s+e*e}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}applyEuler(t){return It.setFromEuler(t),this.applyQuaternion(It)}applyMatrix3(t){const{x:s,y:e,z:i}=this,n=t.elements;return this.x=n[0]*s+n[3]*e+n[6]*i,this.y=n[1]*s+n[4]*e+n[7]*i,this.z=n[2]*s+n[5]*e+n[8]*i,this}applyMatrix4(t){const{x:s,y:e,z:i}=this,n=t.elements,r=n[3]*s+n[7]*e+n[11]*i+n[15],o=r!==0?1/r:1;return this.x=n[0]*s+n[4]*e+n[8]*i+n[12]*o,this.y=n[1]*s+n[5]*e+n[9]*i+n[13]*o,this.z=n[2]*s+n[6]*e+n[10]*i+n[14]*o,this}applyQuaternion(t){const{x:s,y:e,z:i}=this,{x:n,y:r,z:o,w:h}=t,c=t.w*s+t.y*i-t.z*e,a=h*e+o*s-n*i,l=h*i+n*e-r*s,y=-n*s-r*e-o*i;return this.x=c*h+y*-n+a*-o-l*-r,this.y=a*h+y*-r+l*-n-c*-o,this.z=l*h+y*-o+c*-r-a*-n,this}clone(){return new p(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,s){const{x:e,y:i,z:n}=t,{x:r,y:o,z:h}=s;return this.x=i*h-n*o,this.y=n*r-e*h,this.z=e*o-i*r,this}distanceTo(t){return Math.sqrt(this.distanceSqTo(t))}distanceSqTo(t){const s=this.x-t.x,e=this.y-t.y,i=this.z-t.z;return s*s+e*e+i*i}divScalar(t){return this.x/=t,this.y/=t,this.z/=t,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}equals(t){return this.x===t.x&&this.y===t.y&&this.z===t.z}fromArray(t){return this.x=t[0],this.y=t[1],this.z=t[2],this}lerp(t,s){const{x:e,y:i,z:n}=this;return this.x=e+(t.x-e)*s,this.y=i+(t.y-i)*s,this.z=n+(t.z-n)*s,this}mulScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}set(t,s,e){return this.x=t,this.y=s,this.z=e,this}setFromMatrixPosition(t){const s=t.elements;return this.x=s[12],this.y=s[13],this.z=s[14],this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subVectors(t,s){return this.x=t.x-s.x,this.y=t.y-s.y,this.z=t.z-s.z,this}unitize(){return this.divScalar(this.length||1)}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const N=new p,C=new p,tt=new p,Ct=new k;class R{#t=new Float32Array(16);constructor(t){t?this.#t=t:this.identity()}get elements(){return this.#t}clone(){return new R().copy(this)}compose(t,s,e){const i=this.elements,{x:n,y:r,z:o,w:h}=s,c=n+n,a=r+r,l=o+o,y=n*c,d=n*a,w=n*l,g=r*a,m=r*l,x=o*l,E=h*c,A=h*a,S=h*l,{x:P,y:v,z:M}=e;return i[0]=(1-(g+x))*P,i[1]=(d+S)*P,i[2]=(w-A)*P,i[3]=0,i[4]=(d-S)*v,i[5]=(1-(y+x))*v,i[6]=(m+E)*v,i[7]=0,i[8]=(w+A)*M,i[9]=(m-E)*M,i[10]=(1-(y+g))*M,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this}copy(t){const s=t.elements;return s===this.elements?this:(this.elements.set(s),this)}decompose(t,s,e){this.extractPosition(t),this.extractScale(e);const i=new R().extractRotation(this);return s.setFromRotationMatrix(i),this}determinant(){const t=this.elements,[s,e,i,n]=t.subarray(0,4),[r,o,h,c]=t.subarray(4,8),[a,l,y,d]=t.subarray(8,12),[w,g,m,x]=t.subarray(12,16),E=y*x-m*d,A=h*x-m*c,S=h*d-y*c,P=i*x-m*n,v=i*d-y*n,M=i*c-h*n,F=o*E-l*A+g*S,I=e*E-l*P+g*v,O=e*A-o*P+g*M,V=e*S-o*v+l*M;return s*F-r*I+a*O-w*V}extractPosition(t){const s=this.elements;return t.x=s[12],t.y=s[13],t.z=s[14],this}extractRotation(t){const s=t.elements,e=new p;t.extractScale(e);const i=1/e.x,n=1/e.y,r=1/e.z,o=this.elements;return o[0]=s[0]*i,o[1]=s[1]*i,o[2]=s[2]*i,o[3]=0,o[4]=s[4]*n,o[5]=s[5]*n,o[6]=s[6]*n,o[7]=0,o[8]=s[8]*r,o[9]=s[9]*r,o[10]=s[10]*r,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,this}extractScale(t){const s=this.elements;let e=Math.hypot(s[0],s[1],s[2]);const i=Math.hypot(s[4],s[5],s[6]),n=Math.hypot(s[8],s[9],s[10]);return this.determinant()<0&&(e=-e),t.x=e,t.y=i,t.z=n,this}identity(){const t=this.elements;return t[0]=1,t[4]=0,t[8]=0,t[12]=0,t[1]=0,t[5]=1,t[9]=0,t[13]=0,t[2]=0,t[6]=0,t[10]=1,t[14]=0,t[3]=0,t[7]=0,t[11]=0,t[15]=1,this}invert(){const t=this.elements,s=t[0],e=t[1],i=t[2],n=t[3],r=t[4],o=t[5],h=t[6],c=t[7],a=t[8],l=t[9],y=t[10],d=t[11],w=t[12],g=t[13],m=t[14],x=t[15],E=l*m*c-g*y*c+g*h*d-o*m*d-l*h*x+o*y*x,A=w*y*c-a*m*c-w*h*d+r*m*d+a*h*x-r*y*x,S=a*g*c-w*l*c+w*o*d-r*g*d-a*o*x+r*l*x,P=w*l*h-a*g*h-w*o*y+r*g*y+a*o*m-r*l*m,v=s*E+e*A+i*S+n*P;if(v===0)throw new Error("EASEL.Matrix4: non-invertible matrix (det === 0)");const M=1/v;return t[0]=E*M,t[1]=(g*y*n-l*m*n-g*i*d+e*m*d+l*i*x-e*y*x)*M,t[2]=(o*m*n-g*h*n+g*i*c-e*m*c-o*i*x+e*h*x)*M,t[3]=(l*h*n-o*y*n-l*i*c+e*y*c+o*i*d-e*h*d)*M,t[4]=A*M,t[5]=(a*m*n-w*y*n+w*i*d-s*m*d-a*i*x+s*y*x)*M,t[6]=(w*h*n-r*m*n-w*i*c+s*m*c+r*i*x-s*h*x)*M,t[7]=(r*y*n-a*h*n+a*i*c-s*y*c-r*i*d+s*h*d)*M,t[8]=S*M,t[9]=(w*l*n-a*g*n-w*e*d+s*g*d+a*e*x-s*l*x)*M,t[10]=(r*g*n-w*o*n+w*e*c-s*g*c-r*e*x+s*o*x)*M,t[11]=(a*o*n-r*l*n-a*e*c+s*l*c+r*e*d-s*o*d)*M,t[12]=P*M,t[13]=(a*g*i-w*l*i+w*e*y-s*g*y-a*e*m+s*l*m)*M,t[14]=(w*o*i-r*g*i-w*e*h+s*g*h+r*e*m-s*o*m)*M,t[15]=(r*l*i-a*o*i+a*e*h-s*l*h-r*e*y+s*o*y)*M,this}lookAt(t,s,e){N.copy(t).sub(s),N.lengthSq===0&&(N.z=1),N.unitize(),C.copy(e).cross(N),C.lengthSq===0&&(Math.abs(e.z)===1?N.x+=1e-4:N.z+=1e-4,N.unitize(),C.copy(e).cross(N)),C.unitize(),tt.copy(N).cross(C);const i=this.elements;return i[0]=C.x,i[4]=tt.x,i[8]=N.x,i[1]=C.y,i[5]=tt.y,i[9]=N.y,i[2]=C.z,i[6]=tt.z,i[10]=N.z,this}makeOrthographic(t,s,e,i,n,r){const o=1/(s-t),h=1/(e-i),c=1/(r-n),a=this.elements;return a[0]=2*o,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=2*h,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=-2*c,a[11]=0,a[12]=-((s+t)*o),a[13]=-((e+i)*h),a[14]=-((r+n)*c),a[15]=1,this}makePerspective(t,s,e,i){const n=Math.tan(t/2),r=-s*n*e,o=s*n*e,h=n*e,c=-n*e,a=this.elements;return a[0]=2*e/(o-r),a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=2*e/(h-c),a[6]=0,a[7]=0,a[8]=(o+r)/(o-r),a[9]=(h+c)/(h-c),a[10]=-(i+e)/(i-e),a[11]=-1,a[12]=0,a[13]=0,a[14]=-(2*i*e)/(i-e),a[15]=0,this}makeRotationFromEuler(t){return Ct.setFromEuler(t),this.makeRotationFromQuaternion(Ct)}makeRotationFromQuaternion(t){return N.set(0,0,0),C.set(1,1,1),this.compose(N,t,C)}makeRotationX(t){const s=Math.cos(t),e=Math.sin(t),i=this.elements;return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=s,i[6]=e,i[7]=0,i[8]=0,i[9]=-e,i[10]=s,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationY(t){const s=Math.cos(t),e=Math.sin(t),i=this.elements;return i[0]=s,i[1]=0,i[2]=-e,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=e,i[9]=0,i[10]=s,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationZ(t){const s=Math.cos(t),e=Math.sin(t),i=this.elements;return i[0]=s,i[1]=e,i[2]=0,i[3]=0,i[4]=-e,i[5]=s,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeScale(t,s,e){const i=this.elements;return i[0]=t,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=s,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=e,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeTranslation(t,s,e){const i=this.elements;return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=t,i[13]=s,i[14]=e,i[15]=1,this}mul(t){return this.mulMatrices(this,t)}mulMatrices(t,s){const e=t.elements,i=s.elements,n=this.elements,[r,o,h,c,a,l,y,d,w,g,m,x,E,A,S,P]=e.map(K=>K),[v,M,F,I,O,V,U,_,$,at,ct,lt,ut,dt,yt,pt]=i.map(K=>K),L=(K,ms,ws,gs,zs,bs,Ms,Es)=>K*zs+ms*bs+ws*Ms+gs*Es;return n[0]=L(r,a,w,E,v,M,F,I),n[1]=L(o,l,g,A,v,M,F,I),n[2]=L(h,y,m,S,v,M,F,I),n[3]=L(c,d,x,P,v,M,F,I),n[4]=L(r,a,w,E,O,V,U,_),n[5]=L(o,l,g,A,O,V,U,_),n[6]=L(h,y,m,S,O,V,U,_),n[7]=L(c,d,x,P,O,V,U,_),n[8]=L(r,a,w,E,$,at,ct,lt),n[9]=L(o,l,g,A,$,at,ct,lt),n[10]=L(h,y,m,S,$,at,ct,lt),n[11]=L(c,d,x,P,$,at,ct,lt),n[12]=L(r,a,w,E,ut,dt,yt,pt),n[13]=L(o,l,g,A,ut,dt,yt,pt),n[14]=L(h,y,m,S,ut,dt,yt,pt),n[15]=L(c,d,x,P,ut,dt,yt,pt),this}set(t,s,e,i,n,r,o,h,c,a,l,y,d,w,g,m){const x=this.elements;return x[0]=t,x[1]=n,x[2]=c,x[3]=d,x[4]=s,x[5]=r,x[6]=a,x[7]=w,x[8]=e,x[9]=o,x[10]=l,x[11]=g,x[12]=i,x[13]=h,x[14]=y,x[15]=m,this}transpose(){const t=this.elements;let s;return s=t[1],t[1]=t[4],t[4]=s,s=t[2],t[2]=t[8],t[8]=s,s=t[3],t[3]=t[12],t[12]=s,s=t[6],t[6]=t[9],t[9]=s,s=t[7],t[7]=t[13],t[13]=s,s=t[11],t[11]=t[14],t[14]=s,this}*[Symbol.iterator](){const t=this.elements;for(let s=0;s<16;s++)yield t[s]}}const Rt=new R;class X{static#t=.9999999;#s=0;#e=0;#i=0;#n="XYZ";#o=void 0;constructor(t=0,s=0,e=0,i="XYZ"){this.#s=t,this.#e=s,this.#i=e,this.#n=i}get x(){return this.#s}set x(t){this.#s=t,this.#r()}get y(){return this.#e}set y(t){this.#e=t,this.#r()}get z(){return this.#i}set z(t){this.#i=t,this.#r()}get order(){return this.#n}set order(t){this.#n=t,this.#r()}#r(){this.#o&&this.#o()}clone(){return new X(this.x,this.y,this.z,this.order)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.order=t.order,this.#r(),this}fromArray(t){return this.x=t[0],this.y=t[1],this.z=t[2],this.order=t[3]??this.order,this.#r(),this}reorder(t){const s=new k().setFromEuler(this);return this.setFromQuaternion(s,t)}set(t,s,e,i){return this.x=t,this.y=s,this.z=e,i!==void 0&&(this.order=i),this.#r(),this}setFromQuaternion(t,s){return Rt.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Rt,s)}setFromRotationMatrix(t,s){const e=t.elements,i=s||this.order,[n,r,o]=[e[0],e[4],e[8]],[h,c,a]=[e[1],e[5],e[9]],[l,y,d]=[e[2],e[6],e[10]];return this.#y(i,n,r,o,h,c,a,l,y,d),this.order=i,this.#r(),this}setOnChangeCallback(t){return this.#o=t,this}#h(t,s,e,i,n,r,o,h){this.y=f.safeAsin(e),h(e)?(this.x=f.fastAtan2(r,i),this.z=this.z===0?f.fastAtan2(-s,t):this.z):(this.x=f.fastAtan2(-n,o),this.z=f.fastAtan2(-s,t))}#a(t,s,e,i,n,r,o,h){this.x=f.safeAsin(-n),h(n)?(this.y=f.fastAtan2(-r,t),this.z=this.z===0?f.fastAtan2(e,i):this.z):(this.y=f.fastAtan2(s,o),this.z=f.fastAtan2(e,i))}#c(t,s,e,i,n,r,o,h){this.x=f.safeAsin(r),h(r)?(this.z=f.fastAtan2(e,t),this.y=this.y===0?f.fastAtan2(-n,o):this.y):(this.y=f.fastAtan2(-n,o),this.z=f.fastAtan2(-s,i))}#l(t,s,e,i,n,r,o,h){this.y=f.safeAsin(-n),h(n)?(this.z=f.fastAtan2(-s,i),this.x=this.x===0?f.fastAtan2(r,o):this.x):(this.x=f.fastAtan2(r,o),this.z=f.fastAtan2(e,t))}#u(t,s,e,i,n,r,o,h){this.z=f.safeAsin(e),h(e)?(this.y=f.fastAtan2(s,o),this.x=this.x===0?f.fastAtan2(-n,i):this.x):(this.x=f.fastAtan2(-n,i),this.y=f.fastAtan2(-r,t))}#d(t,s,e,i,n,r){this.z=f.safeAsin(-s),r(s)?(this.x=f.fastAtan2(n,i),this.y=this.y===0?f.fastAtan2(e,t):this.y):(this.x=f.fastAtan2(n,i),this.y=f.fastAtan2(e,t))}#y(t,s,e,i,n,r,o,h,c,a){const l=y=>Math.abs(y)>=X.#t;switch(t){case"XYZ":this.#h(s,e,i,r,o,c,a,l);break;case"YXZ":this.#a(s,i,n,r,o,h,a,l);break;case"ZXY":this.#c(s,e,n,r,h,c,a,l);break;case"ZYX":this.#l(s,e,n,r,h,c,a,l);break;case"YZX":this.#u(s,i,n,r,o,h,a,l);break;case"XZY":this.#d(s,e,i,r,c,l);break;default:throw new Error(`EASEL.Euler: unknown Euler order: ${t}`)}}}const xt=new p,st=new R,kt=new k;class q{id=crypto.randomUUID();name="";position=new p;#t=new X;#s=new k;scale=new p(1,1,1);matrix=new R;worldMatrix=new R;autoUpdateMatrix=!0;parent=void 0;children=[];visible=!0;frustumCulled=!0;userData={};constructor(){this.#t.setOnChangeCallback(()=>{this.#s.setFromEuler(this.#t)}),this.updateMatrix()}get rotation(){return this.#t}set rotation(t){this.#t.copy(t)}get quaternion(){return this.#s}set quaternion(t){this.#s.copy(t),this.#t.setFromQuaternion(this.#s)}get isCamera(){return"projectionMatrix"in this&&"matrixWorldInverse"in this}get isMesh(){return Object.getPrototypeOf(this).constructor.name==="Mesh"}add(t){return t===this?this:(t.parent?.remove(t),t.parent=this,this.children.push(t),this)}clone(){return new q().copy(this)}copy(t,s=!0){if(this.id=crypto.randomUUID(),this.name=t.name,this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.worldMatrix.copy(t.worldMatrix),this.visible=t.visible,this.userData=JSON.parse(JSON.stringify(t.userData)),s)for(const e of t.children)this.add(e.clone());return this}lookAt(t,s,e){this.updateWorldMatrix(!0,!1);const i=t instanceof p?t:new p(t,s,e);return xt.setFromMatrixPosition(this.worldMatrix),st.lookAt(this.isCamera?xt:i,this.isCamera?i:xt,new p(0,1,0)),this.quaternion.setFromRotationMatrix(st),this.parent&&(st.extractRotation(this.parent.worldMatrix),kt.setFromRotationMatrix(st),this.quaternion.premul(kt.invert())),this.rotation.setFromQuaternion(this.quaternion),this}remove(t){const s=this.children.indexOf(t);return s!==-1&&(t.parent=void 0,this.children.splice(s,1)),this}traverse(t){t(this);for(const s of this.children)s.traverse(t)}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale)}updateWorldMatrix(t=!1,s=!0){if(t&&this.parent&&this.parent.updateWorldMatrix(!0,!1),this.autoUpdateMatrix&&this.updateMatrix(),this.worldMatrix=this.parent?this.worldMatrix.mulMatrices(this.parent.worldMatrix,this.matrix):this.worldMatrix.copy(this.matrix),s)for(const e of this.children)e.updateWorldMatrix(!1,!0)}}class B extends q{projectionMatrix=new R;matrixWorldInverse=new R;constructor(){super(),this.name="Camera"}updateMatrixWorld(t=!1){super.updateWorldMatrix(t,!1),this.matrixWorldInverse.copy(this.worldMatrix).invert()}updateProjectionMatrix(){throw new Error("EASEL.Camera: must be implemented in subclass")}clone(){return new B().copy(this)}copy(t){return super.copy(t),this.projectionMatrix.copy(t.projectionMatrix),this.matrixWorldInverse.copy(t.matrixWorldInverse),this}}class mt extends B{#t=-1;#s=1;#e=1;#i=-1;#n=.1;#o=2e3;constructor(t=-1,s=1,e=1,i=-1,n=.1,r=2e3){super(),this.name="OrthoCamera",this.left=t,this.right=s,this.top=e,this.bottom=i,this.near=n,this.far=r,this.updateProjectionMatrix()}get left(){return this.#t}set left(t){this.#t=t,this.updateProjectionMatrix()}get right(){return this.#s}set right(t){this.#s=t,this.updateProjectionMatrix()}get top(){return this.#e}set top(t){this.#e=t,this.updateProjectionMatrix()}get bottom(){return this.#i}set bottom(t){this.#i=t,this.updateProjectionMatrix()}get near(){return this.#n}set near(t){this.#n=t,this.updateProjectionMatrix()}get far(){return this.#o}set far(t){this.#o=t,this.updateProjectionMatrix()}clone(){return new mt(this.left,this.right,this.top,this.bottom,this.near,this.far)}copy(t){return super.copy(t),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this}updateProjectionMatrix(){this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far)}}class et extends B{#t=50;#s=1;#e=.1;#i=2e3;constructor(t=50,s=1,e=.1,i=2e3){super(),this.name="PerspCamera",this.fov=t,this.aspect=s,this.near=e,this.far=i,this.updateProjectionMatrix()}get fov(){return this.#t}set fov(t){this.#t=t,this.updateProjectionMatrix()}get aspect(){return this.#s}set aspect(t){this.#s=t,this.updateProjectionMatrix()}get near(){return this.#e}set near(t){this.#e=t}get far(){return this.#i}set far(t){this.#i=t,this.updateProjectionMatrix()}clone(){return new et(this.fov,this.aspect,this.near,this.far)}copy(t){return super.copy(t),this.fov=t.fov,this.aspect=t.aspect,this.near=t.near,this.far=t.far,this}updateProjectionMatrix(){this.projectionMatrix.makePerspective(f.toRadians(this.fov),this.aspect,this.near,this.far)}}class ts{#t;#s=0;#e=0;#i=0;#n=!1;constructor(t=!0){this.#t=t}get elapsedTime(){return this.delta,this.#i}get delta(){let t=0;if(this.#t&&!this.#n)return this.start(),0;if(this.#n){const s=qt();t=(s-this.#e)/1e3,this.#e=s,this.#i+=t}return t}start(){this.#s=qt(),this.#e=this.#s,this.#i=0,this.#n=!0}stop(){this.elapsedTime,this.#n=!1,this.#t=!1}}function qt(){return(typeof performance>"u"?Date:performance).now()}class b{static HUE_SCALE=360;static SATURATION_SCALE=100;static LIGHTNESS_SCALE=100;static RGB_SCALE=255;static toRgb(t){const s=new b(t);return{r:f.fastTrunc(s.r*b.RGB_SCALE),g:f.fastTrunc(s.g*b.RGB_SCALE),b:f.fastTrunc(s.b*b.RGB_SCALE)}}r=1;g=1;b=1;constructor(...t){t.length>0?this.set(...t):this.r=this.g=this.b=0}get hex(){return this.r*b.RGB_SCALE<<16^this.g*b.RGB_SCALE<<8^this.b*b.RGB_SCALE<<0}get hexString(){return`#${this.hex.toString(16).padStart(6,"0")}`}get hsl(){const t=this.r,s=this.g,e=this.b,i=Math.max(t,s,e),n=Math.min(t,s,e);let r=0,o=0;const h=(n+i)/2;if(n!==i){const c=i-n;o=h>.5?c/(2-i-n):c/(i+n),r=i===t?(s-e)/c+(s<e?6:0):i===s?(e-t)/c+2:(t-s)/c+4,r/=6}return{h:r,s:o,l:h}}get hslString(){const t=this.hsl,s=f.fastTrunc(t.h*b.HUE_SCALE),e=f.fastTrunc(t.s*b.SATURATION_SCALE),i=f.fastTrunc(t.l*b.LIGHTNESS_SCALE);return`hsl(${s},${e}%,${i}%)`}clone(){return new b(this)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}parse(t){if(t instanceof b)return this.copy(t),this;if(typeof t=="number")return this.setHex(t);if(typeof t=="string")return this.setStyle(t);throw new Error(`EASEL.Color: invalid value: ${t}`)}set(...t){if(t.length===1){const s=t[0];s instanceof b?this.copy(s):typeof s=="number"?this.setHex(s):typeof s=="string"&&this.setStyle(s)}else t.length===3&&this.setRgb(t[0],t[1],t[2]);return this}setHex(t){if(t>16777215||t<0)throw new Error("EASEL.Color: hex out of range");const s=f.fastTrunc(t);return this.r=(s>>16)/b.RGB_SCALE,this.g=(s>>8&b.RGB_SCALE)/b.RGB_SCALE,this.b=(s&b.RGB_SCALE)/b.RGB_SCALE,this}setHsl(t,s,e){const i=(n,r,o)=>{const h=o<0?o+1:o>1?o-1:o;return h<.16666666666666666?n+(r-n)*6*h:h<.5?r:h<.6666666666666666?n+(r-n)*(.6666666666666666-h)*6:n};if(s===0)this.r=this.g=this.b=e;else{const n=e<.5?e*(1+s):e+s-e*s,r=2*e-n;this.r=i(r,n,t+1/3),this.g=i(r,n,t),this.b=i(r,n,t-1/3)}return this}setRgb(t,s,e){if(t>b.RGB_SCALE||s>b.RGB_SCALE||e>b.RGB_SCALE)throw new Error("EASEL.Color: rgb out of range");return this.r=t,this.g=s,this.b=e,this}setStyle(t){const s=t.toLowerCase();if(s.startsWith("#"))return this.#t(s);if(s.startsWith("rgb"))return this.#e(s);if(s.startsWith("hsl"))return this.#s(s);throw new Error(`EASEL.Color: invalid style: ${t}`)}#t(t){if(t.length!==4&&t.length!==7)throw new Error("EASEL.Color: hex style must be in '#rgb' or '#rrggbb' format");const s=t.length===4?t.slice(1).split("").map(e=>e+e).join(""):t.slice(1);return this.setHex(Number.parseInt(s,16))}#s(t){const s=t.match(/\d+/g);if(!s||s.length<3)throw new Error("EASEL.Color: hsl(a) style must be in 'hsl(h,s%,l%)' or 'hsla(h,s%,l%,a)' format");const e=Number(s[0])/b.HUE_SCALE,i=Number(s[1])/b.SATURATION_SCALE,n=Number(s[2])/b.LIGHTNESS_SCALE,r=n<.5?n*(1+i):n+i-n*i,o=2*n-r,h=(c,a,l)=>{const y=l<0?l+1:l>1?l-1:l;return y<1/6?c+(a-c)*6*y:y<1/2?a:y<2/3?c+(a-c)*(2/3-y)*6:c};return this.r=h(o,r,e+1/3),this.g=h(o,r,e),this.b=h(o,r,e-1/3),this}#e(t){const s=t.match(/\d+/g);if(!s||s.length<3)throw new Error("EASEL.Color: rgb style must be in 'rgb(r,g,b)' or 'rgba(r,g,b,a)' format");return this.setRgb(Number(s[0])/b.RGB_SCALE,Number(s[1])/b.RGB_SCALE,Number(s[2])/b.RGB_SCALE)}}class it extends q{#t=new b(1,1,1);#s=1;constructor(t,s=1){super(),this.name="Light",this.color!==void 0&&this.color,this.intensity=s}get color(){return this.#t}set color(t){t instanceof b?this.#t.copy(t):this.#t.parse(t)}get intensity(){return this.#s}set intensity(t){this.#s=t}clone(){return new it(this.color,this.intensity).copy(this)}copy(t){return super.copy(t),this.color=t.color,this.intensity=t.intensity,this}}class wt extends it{#t=new p(0,-1,0);#s=new p;constructor(t,s=1){super(t,s),this.name="DirectionalLight"}get direction(){return this.#t}set direction(t){this.#t.copy(t).unitize()}get target(){return this.#s}set target(t){this.#s.copy(t),this.#e()}setFromDirection(t){return this.direction.copy(t).unitize(),this}#e(){this.#t.copy(this.position).sub(this.target).unitize().negate()}clone(){return new wt(this.color,this.intensity).copy(this)}copy(t){return super.copy(t),this.direction.copy(t.direction),this.target.copy(t.target),this}updateWorldMatrix(t=!1,s=!0){super.updateWorldMatrix(t,s),this.#e()}}const nt={front:0,back:1,double:2};class rt{color;opacity;dithering;side;vertexColors;visible;fog;wireframe;constructor(t={}){this.color=t.color??16777215,this.opacity=t.opacity??1,this.dithering=t.dithering??!1,this.side=t.side??nt.front,this.vertexColors=t.vertexColors??!1,this.visible=t.visible??!0,this.fog=t.fog??!0,this.wireframe=t.wireframe??!1}clone(){return new rt().copy(this)}copy(t){return this.color=t.color,this.opacity=t.opacity,this.dithering=t.dithering,this.side=t.side,this.vertexColors=t.vertexColors,this.visible=t.visible,this.fog=t.fog,this.wireframe=t.wireframe,this}}class H extends q{#t;#s;constructor(t,s){super(),this.#t=t,this.#s=s,this.updateMatrix()}get shape(){return this.#t}set shape(t){this.#t=t,this.updateMatrix()}get material(){return this.#s}set material(t){this.#s=t}clone(){return new H(this.shape.clone(),this.material.clone()).copy(this)}copy(t){return super.copy(t),this.shape=t.shape.clone(),this.material=t.material.clone(),this}}const Z={calculateNormal(u,t,s,e=new p){const i=new p().subVectors(t,u),n=new p().subVectors(s,u);return e.crossVectors(i,n),e.lengthSq?e.unitize():e.set(0,0,1)},isCounterClockwise(u,t,s){const e=u.x,i=u.z,n=t.x,r=t.z,o=s.x,h=s.z;return(n-e)*(h-i)-(r-i)*(o-e)>0},triangulate(u){if(u.length<3)return new Uint16Array;if(u.length===3)return new Uint16Array([0,1,2]);if(u.length===4)return new Uint16Array([0,1,3,1,2,3]);const t=ns(u.length),s=new Uint16Array(u.length*3),e={triangleCount:0,remainingVertices:u.length};return as(u,t,s,e),e.remainingVertices===3&&ss(t,s,e),s.slice(0,e.triangleCount)}};function ss(u,t,s){t[s.triangleCount++]=u[0]??0,t[s.triangleCount++]=u[1]??1,t[s.triangleCount++]=u[2]??2}function es(u,t,s,e,i,n){t[n.triangleCount++]=u[s]??0,t[n.triangleCount++]=u[e]??0,t[n.triangleCount++]=u[i]??0}function is(u,t,s,e){for(let i=0;i<e.remainingVertices;i++){const n=i===0?e.remainingVertices-1:i-1,r=i,o=i===e.remainingVertices-1?0:i+1;if(rs(t,u,n,r,o,e.remainingVertices))return es(t,s,n,r,o,e),cs(t,r,e),!0}return!1}function ns(u){const t=new Uint16Array(u);for(let s=0;s<u;s++)t[s]=s;return t}function rs(u,t,s,e,i,n){const r=t[u[s]??0],o=t[u[e]??0],h=t[u[i]??0];return r&&o&&h&&Z.isCounterClockwise(r,o,h)?!os(u,t,s,e,i,n,r,o,h):!1}function os(u,t,s,e,i,n,r,o,h){for(let c=0;c<n;c++){if(c===s||c===e||c===i)continue;const a=u[c];if(a===void 0||a<0||a>=t.length)continue;const l=t[a];if(l&&hs(l,r,o,h))return!0}return!1}function hs(u,t,s,e){const i=e.x-t.x,n=e.z-t.z,r=s.x-t.x,o=s.z-t.z,h=u.x-t.x,c=u.z-t.z,a=i*i+n*n,l=i*r+n*o,y=i*h+n*c,d=r*r+o*o,w=r*h+o*c,g=1/(a*d-l*l),m=(d*y-l*w)*g,x=(a*w-l*y)*g;return m>=0&&x>=0&&m+x<=1}function as(u,t,s,e){for(;e.remainingVertices>3&&is(u,t,s,e););}function cs(u,t,s){for(let e=t;e<s.remainingVertices-1;e++)u[e]=u[e+1]??0;s.remainingVertices--}class Y{vertices=[];indices=new Uint16Array([]);faceNormals=[];clone(){return new Y().copy(this)}computeFaceNormals(){this.faceNormals=[];for(let t=0;t<this.indices.length;t+=3){const s=this.indices[t],e=this.indices[t+1],i=this.indices[t+2];if(!(s&&e&&i))throw new Error(`EASEL.Shape: invalid index at ${t} (${s}, ${e}, ${i})`);const n=this.vertices[s],r=this.vertices[e],o=this.vertices[i];n&&r&&o&&this.faceNormals.push(Z.calculateNormal(n,r,o))}return this}copy(t){return this.vertices=t.vertices.map(s=>s.clone()),this.indices=t.indices,this}}class ls{load(t,s,e,i){fetch(t).then(n=>{if(!n.ok)throw new Error(`EASEL.Loader: failed to load file: ${n.statusText}`);return n.text()}).then(n=>{s(this.parse(n))}).catch(i).finally(()=>{e?.(new ProgressEvent("load"))})}}const gt=new Map;let Ot=0;const us=/\s+/;class ds extends ls{#t=[];#s=[];#e=new Float32Array(0);#i=[];#n=new Uint16Array(0);parse(t){this.#l();const s=t.split(`
`);for(const n of s){const r=n.trim();if(r===""||r.startsWith("#"))continue;const o=r.split(us);if(o.length<2)continue;const h=o[0]?.toLowerCase();if(h)switch(h){case"v":this.#a(o);break;case"vn":this.#r(o);break;case"vt":this.#h(o);break;case"f":this.#o(o);break;default:throw new Error(`EASEL.ObjLoader: unsupported command: ${h}`)}}const e=new Y;e.vertices=this.#i,e.indices=this.#n;const i=new H(e,new rt);return new q().add(i)}#o(t){const s=[];for(let e=1;e<t.length;e++){const i=t[e];i&&s.push(this.#c(i))}if(s.length===3){const e=s[0],i=s[1],n=s[2];e!==void 0&&i!==void 0&&n!==void 0&&(this.#n=new Uint16Array([...this.#n,e,i,n]))}else if(s.length>3){const e=s[0];if(e!==void 0)for(let i=1;i<s.length-1;i++){const n=s[i],r=s[i+1];n!==void 0&&r!==void 0&&(this.#n=new Uint16Array([...this.#n,e,n,r]))}}}#r(t){const s=Number.parseFloat(t[1]??"0"),e=Number.parseFloat(t[2]??"0"),i=Number.parseFloat(t[3]??"0");this.#s.push(new p(s,e,i))}#h(t){const s=Number.parseFloat(t[1]??"0"),e=t.length>2?Number.parseFloat(t[2]??"0"):0;this.#e=new Float32Array([...this.#e,s,e])}#a(t){const s=Number.parseFloat(t[1]??"0"),e=Number.parseFloat(t[2]??"0"),i=Number.parseFloat(t[3]??"0");this.#t.push(new p(s,e,i))}#c(t){const s=gt.get(t);if(s!==void 0)return s;const e=t.split("/"),i=Number.parseInt(e[0]??"0")-1,n=this.#t[i];if(!n)throw new Error(`EASEL.ObjLoader: invalid vertex position index: ${i+1}`);const r=n.clone();this.#i.push(r);const o=Ot++;return gt.set(t,o),o}#l(){this.#t=[],this.#s=[],this.#e=new Float32Array(0),this.#i=[],this.#n=new Uint16Array(0),gt.clear(),Ot=0}}class zt{#t;#s;constructor(t,s){this.#t=t?t.clone():new p(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),this.#s=s?s.clone():new p(-Number.NEGATIVE_INFINITY,-Number.NEGATIVE_INFINITY,-Number.NEGATIVE_INFINITY)}get min(){return this.#t}set min(t){this.#t.copy(t)}get max(){return this.#s}set max(t){this.#s.copy(t)}get centre(){return this.#t.clone().add(this.#s).mulScalar(.5)}get size(){return this.#s.clone().sub(this.#t)}get width(){return this.#s.x-this.#t.x}get height(){return this.#s.y-this.#t.y}get depth(){return this.#s.z-this.#t.z}get corners(){const{x:t,y:s,z:e}=this.#t,{x:i,y:n,z:r}=this.#s;return[new p(t,s,e),new p(i,s,e),new p(t,n,e),new p(i,n,e),new p(t,s,r),new p(i,s,r),new p(t,n,r),new p(i,n,r)]}get isEmpty(){return this.#s.x<this.#t.x||this.#s.y<this.#t.y||this.#s.z<this.#t.z}clone(){return new zt(this.#t.clone(),this.#s.clone())}containsBox(t){return this.#t.x<=t.min.x&&this.#s.x>=t.max.x&&this.#t.y<=t.min.y&&this.#s.y>=t.max.y&&this.#t.z<=t.min.z&&this.#s.z>=t.max.z}containsPoint(t){return t.x>=this.#t.x&&t.x<=this.#s.x&&t.y>=this.#t.y&&t.y<=this.#s.y&&t.z>=this.#t.z&&t.z<=this.#s.z}copy(t){return this.#t.copy(t.min),this.#s.copy(t.max),this}equals(t){return t.min.equals(this.#t)&&t.max.equals(this.#s)}expandByPoint(t){const{x:s,y:e,z:i}=this.#t,{x:n,y:r,z:o}=this.#s,{x:h,y:c,z:a}=t;return this.#t.x=f.fastMin(s,h),this.#t.y=f.fastMin(e,c),this.#t.z=f.fastMin(i,a),this.#s.x=f.fastMax(n,h),this.#s.y=f.fastMax(r,c),this.#s.z=f.fastMax(o,a),this}expandByScalar(t){return this.#t.x-=t,this.#t.y-=t,this.#t.z-=t,this.#s.x+=t,this.#s.y+=t,this.#s.z+=t,this}expandByVector3(t){return this.#t.sub(t),this.#s.add(t),this}getCentre(t){return t.copy(this.#t).add(this.#s).mulScalar(.5)}intersectsBox(t){return this.#s.x>=t.min.x&&this.#t.x<=t.max.x&&this.#s.y>=t.min.y&&this.#t.y<=t.max.y&&this.#s.z>=t.min.z&&this.#t.z<=t.max.z}intersectsSphere(t){const s=new p;return s.x=f.fastMin(f.fastMax(t.center.x,this.#t.x),this.#s.x),s.y=f.fastMin(f.fastMax(t.center.y,this.#t.y),this.#s.y),s.z=f.fastMin(f.fastMax(t.center.z,this.#t.z),this.#s.z),s.clone().sub(t.center).lengthSq<=t.radius*t.radius}makeEmpty(){return this.#t.set(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),this.#s.set(-Number.NEGATIVE_INFINITY,-Number.NEGATIVE_INFINITY,-Number.NEGATIVE_INFINITY),this}setFromCentreAndSize(t,s){const e=s.clone().mulScalar(.5);return this.#t.copy(t).sub(e),this.#s.copy(t).add(e),this}setFromObject(t){this.makeEmpty();const s=e=>{if(e.isMesh&&e.shape?.vertices?.length>0){const n=e.shape.vertices;e.updateWorldMatrix(!1,!1);for(const r of n){const o=r.clone().applyMatrix4(e.worldMatrix);this.expandByPoint(o)}}for(const i of e.children)i.visible&&s(i)};return t.updateWorldMatrix(!0,!1),s(t),this}setFromPoints(t){this.makeEmpty();for(const s of t)this.expandByPoint(s);return this}translate(t){return this.#t.add(t),this.#s.add(t),this}union(t){const{x:s,y:e,z:i}=this.#t,{x:n,y:r,z:o}=this.#s,{x:h,y:c,z:a}=t.min,{x:l,y,z:d}=t.max;return this.#t.x=f.fastMin(s,h),this.#t.y=f.fastMin(e,c),this.#t.z=f.fastMin(i,a),this.#s.x=f.fastMax(n,l),this.#s.y=f.fastMax(r,y),this.#s.z=f.fastMax(o,d),this}}class ot{#t=0;#s=0;constructor(t=0,s=0){this.#t=t,this.#s=s}get x(){return this.#t}set x(t){this.#t=t}get y(){return this.#s}set y(t){this.#s=t}add(t){return this.x+=t.x,this.y+=t.y,this}clone(){return new ot(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}equals(t){return this.x===t.x&&this.y===t.y}fromArray(t){return this.x=t[0],this.y=t[1],this}mulScalar(t){return this.x*=t,this.y*=t,this}set(t,s){return this.x=t,this.y=s,this}sub(t){return this.x-=t.x,this.y-=t.y,this}*[Symbol.iterator](){yield this.x,yield this.y}}class Q{#t=new Float32Array(9);constructor(t){t?this.#t=t:this.identity()}get elements(){return this.#t}clone(){return new Q().copy(this)}compose(t,s,e){this.makeRotation(s);const i=this.elements,n=i[0]??1,r=i[1],o=i[3],h=i[4]??1;return i[0]=n*e.x,i[3]=o*e.x,i[1]=r*e.y,i[4]=h*e.y,i[6]=t.x,i[7]=t.y,this}copy(t){const s=t.elements;return s===this.elements?this:(this.elements.set(s),this)}decompose(t,s,e){this.extractPosition(t),this.extractScale(e);const i=new Q().extractRotation(this);return s.angle=f.fastAtan2(i.elements[1],i.elements[0]??1),this}determinant(){const t=this.elements,s=t[0],e=t[1],i=t[2],n=t[3],r=t[4],o=t[5],h=t[6],c=t[7],a=t[8]??1;return s*(r*a-o*c)-e*(n*a-o*h)+i*(n*c-r*h)}extractPosition(t){const s=this.elements;return t.x=s[6],t.y=s[7],this}extractRotation(t){const s=t.elements,e=new ot;t.extractScale(e);const i=1/e.x,n=1/e.y,r=this.elements;return r[0]=s[0]*i,r[1]=s[1]*i,r[2]=0,r[3]=s[3]*n,r[4]=s[4]*n,r[5]=0,r[6]=0,r[7]=0,r[8]=1,this}extractScale(t){const s=this.elements,e=Math.hypot(s[0],s[3]),i=Math.hypot(s[1],s[4]);return t.x=e,t.y=i,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}identity(){const t=this.elements;return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,this}invert(){const t=this.elements,s=t[0],e=t[1],i=t[2],n=t[3],r=t[4],o=t[5],h=t[6],c=t[7],a=t[8],l=this.determinant();if(l===0)throw new Error("EASEL.Matrix3: non-invertible matrix (det === 0)");const y=1/l;return t[0]=(r*a-o*c)*y,t[1]=(i*c-e*a)*y,t[2]=(e*o-i*r)*y,t[3]=(o*h-n*a)*y,t[4]=(s*a-i*h)*y,t[5]=(i*n-s*o)*y,t[6]=(n*c-r*h)*y,t[7]=(e*h-s*c)*y,t[8]=(s*r-e*n)*y,this}makeRotation(t){const s=Math.cos(t),e=Math.sin(t),i=this.elements;return i[0]=s,i[1]=e,i[2]=0,i[3]=-e,i[4]=s,i[5]=0,i[6]=0,i[7]=0,i[8]=1,this}makeScale(t,s){const e=this.elements;return e[0]=t,e[1]=0,e[2]=0,e[3]=0,e[4]=s,e[5]=0,e[6]=0,e[7]=0,e[8]=1,this}makeTranslation(t,s){const e=this.elements;return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t,e[7]=s,e[8]=1,this}mul(t){return this.mulMatrices(this,t)}mulMatrices(t,s){const e=t.elements,i=s.elements,n=this.elements,[r,o,h,c,a,l,y,d,w]=e.map(I=>I),[g,m,x,E,A,S,P,v,M]=i.map(I=>I),F=(I,O,V,U,_,$)=>I*U+O*_+V*$;return n[0]=F(r,c,y,g,m,x),n[1]=F(o,a,d,g,m,x),n[2]=F(h,l,w,g,m,x),n[3]=F(r,c,y,E,A,S),n[4]=F(o,a,d,E,A,S),n[5]=F(h,l,w,E,A,S),n[6]=F(r,c,y,P,v,M),n[7]=F(o,a,d,P,v,M),n[8]=F(h,l,w,P,v,M),this}set(t,s,e,i,n,r,o,h,c){const a=this.elements;return a[0]=t,a[1]=i,a[2]=o,a[3]=s,a[4]=n,a[5]=h,a[6]=e,a[7]=r,a[8]=c,this}setFromMatrix4(t){const s=t.elements,e=this.elements;return e[0]=s[0],e[1]=s[1],e[2]=s[2],e[3]=s[4],e[4]=s[5],e[5]=s[6],e[6]=s[8],e[7]=s[9],e[8]=s[10],this}transpose(){const t=this.elements;let s;return s=t[1],t[1]=t[3],t[3]=s,s=t[2],t[2]=t[6],t[6]=s,s=t[5],t[5]=t[7],t[7]=s,this}*[Symbol.iterator](){const t=this.elements;yield t[0],yield t[1],yield t[2],yield t[3],yield t[4],yield t[5],yield t[6],yield t[7],yield t[8]}}class T{#t=new p(1,0,0);#s=0;constructor(t=new p(1,0,0),s=0){const e=t.length;this.#t=t.clone().unitize(),this.#s=s/e}get normal(){return this.#t}set normal(t){this.#t.copy(t).unitize()}get constant(){return this.#s}set constant(t){this.#s=t}applyMatrix4(t){const s=new Q().getNormalMatrix(t),e=this.coplanarPoint(new p).applyMatrix4(t);return this.normal.applyMatrix3(s).unitize(),this.constant=-e.dot(this.normal),this}coplanarPoint(t=new p){return t.copy(this.normal).mulScalar(-this.constant)}clone(){return new T(this.normal,this.constant)}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}distanceToPoint(t){return this.normal.dot(t)+this.constant}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}intersectLine(t,s=new p){const e=t.end.sub(t.start),i=this.normal.dot(e);if(i===0)return this.distanceToPoint(t.start)===0?s.copy(t.start):void 0;const n=-(t.start.dot(this.normal)+this.constant)/i;if(!(n<0||n>1))return s.copy(e).mulScalar(n).add(t.start)}intersectsSphere(t){return this.distanceToPoint(t.center)<=t.radius}projectPoint(t,s=new p){return s.copy(this.normal).mulScalar(-this.distanceToPoint(t)).add(t)}setComponents(t,s,e,i){return this.normal.set(t,s,e),this.constant=i,this}setFromCoplanarPoints(t,s,e){const i=s.clone().sub(t),n=e.clone().sub(t),r=i.clone().cross(n).unitize();return this.setFromNormalAndCoplanarPoint(r,t),this}setFromNormalAndCoplanarPoint(t,s){return this.normal.copy(t).unitize(),this.constant=-s.clone().dot(this.normal),this}translate(t){return this.constant-=t.dot(this.normal),this}unitize(){const t=this.normal.length;return this.normal.divScalar(t),this.constant/=t,this}}class ht{planes=[];constructor(){this.planes.push(new T),this.planes.push(new T),this.planes.push(new T),this.planes.push(new T),this.planes.push(new T),this.planes.push(new T)}clone(){return new ht().copy(this)}containsPoint(t){const s=this.planes;if(s.length!==6)throw new Error("EASEL.Frustum: planes array must have 6 elements");for(let e=0;e<6;e++){const i=s[e];if(!i)throw new Error(`EASEL.Frustum: undefined Plane ${e}`);if(i.distanceToPoint(t)<0)return!1}return!0}copy(t){const s=this.planes;for(let e=0;e<6;e++)s[e]?.copy(t.planes[e]??new T);return this}intersectsBox(t){const s=this.planes;if(s.length!==6)throw new Error("EASEL.Frustum: planes array must have 6 elements");for(let e=0;e<6;e++){const i=s[e];if(!i)throw new Error(`EASEL.Frustum: undefined Plane ${e}`);const n=i.normal,r=n.x>0?t.max.x:t.min.x,o=n.y>0?t.max.y:t.min.y,h=n.z>0?t.max.z:t.min.z;if(i.distanceToPoint({x:r,y:o,z:h})<0)return!1}return!0}intersectsSphere(t){const s=this.planes;if(s.length!==6)throw new Error("EASEL.Frustum: planes array must have 6 elements");const e=t.center,i=-t.radius;for(let n=0;n<6;n++){const r=s[n];if(!r)throw new Error(`EASEL.Frustum: undefined Plane ${n}`);if(r.distanceToPoint(e)<i)return!1}return!0}makeEmpty(){for(let t=0;t<6;t++)this.planes[t]=new T;return this}setFromProjectionMatrix(t){const s=t.elements,e=this.planes;return this.#e(e,s),this}#t(t){return Array.from({length:16},(s,e)=>t[e])}#s(t,s){this.#i(t,s),this.#n(t,s),this.#o(t,s),this.#r(t,s),this.#h(t,s),this.#a(t,s)}#e(t,s){const e=this.#t(s);this.#s(t,e)}#i(t,s){const e=t[0]??new T;t[0]=e,e.setComponents(s[3]-s[0],s[7]-s[4],s[11]-s[8],s[15]-s[12]).unitize()}#n(t,s){const e=t[1]??new T;t[1]=e,e.setComponents(s[3]+s[0],s[7]+s[4],s[11]+s[8],s[15]+s[12]).unitize()}#o(t,s){const e=t[2]??new T;t[2]=e,e.setComponents(s[3]+s[1],s[7]+s[5],s[11]+s[9],s[15]+s[13]).unitize()}#r(t,s){const e=t[3]??new T;t[3]=e,e.setComponents(s[3]-s[1],s[7]-s[5],s[11]-s[9],s[15]-s[13]).unitize()}#h(t,s){const e=t[4]??new T;t[4]=e,e.setComponents(s[3]-s[2],s[7]-s[6],s[11]-s[10],s[15]-s[14]).unitize()}#a(t,s){const e=t[5]??new T;t[5]=e,e.setComponents(s[3]+s[2],s[7]+s[6],s[11]+s[10],s[15]+s[14]).unitize()}}class bt{#t=new p;#s=new p;constructor(t=new p,s=new p){this.#t=t.clone(),this.#s=s.clone()}get start(){return this.#t}set start(t){this.#t.copy(t)}get end(){return this.#s}set end(t){this.#s.copy(t)}get delta(){return this.#s.clone().sub(this.#t)}get length(){return this.#t.distanceTo(this.#s)}get lengthSq(){return this.#t.distanceSqTo(this.#s)}applyMatrix4(t){return this.#t.applyMatrix4(t),this.#s.applyMatrix4(t),this}at(t,s=new p){return s.copy(this.delta).mulScalar(t).add(this.#t)}clone(){return new bt(this.#t,this.#s)}closestPointToPoint(t,s=!0,e=new p){const i=this.closestPointToPointParameter(t,s);return this.at(i,e)}closestPointToPointParameter(t,s=!0){const e=t.clone().sub(this.#t),i=this.delta,n=i.lengthSq;if(n===0)return 0;const r=e.dot(i)/n;return s?f.clamp(r,0,1):r}copy(t){return this.#t.copy(t.start),this.#s.copy(t.end),this}equals(t){return this.#t.equals(t.start)&&this.#s.equals(t.end)}getCenter(t=new p){return t.copy(this.#t).add(this.#s).mulScalar(.5)}set(t,s){return this.#t.copy(t),this.#s.copy(s),this}}class Mt{#t=new p;#s=1;constructor(t=new p,s=1){this.#t=t.clone(),this.#s=s}get center(){return this.#t}set center(t){this.#t.copy(t)}get radius(){return this.#s}set radius(t){this.#s=t}clone(){return new Mt(this.center,this.radius)}containsPoint(t){return t.clone().sub(this.center).lengthSq<=this.radius*this.radius}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}distanceToPoint(t){return t.clone().sub(this.center).length-this.radius}equals(t){return t.center.x===this.center.x&&t.center.y===this.center.y&&t.center.z===this.center.z&&t.radius===this.radius}intersectsSphere(t){const s=this.radius+t.radius;return this.center.clone().sub(t.center).lengthSq<=s*s}translate(t){return this.center.add(t),this}}class Et{#t=0;#s=0;#e=0;#i=1;constructor(t=0,s=0,e=0,i=1){this.#t=t,this.#s=s,this.#e=e,this.#i=i}get x(){return this.#t}set x(t){this.#t=t}get y(){return this.#s}set y(t){this.#s=t}get z(){return this.#e}set z(t){this.#e=t}get w(){return this.#i}set w(t){this.#i=t}get length(){return Math.sqrt(this.lengthSq)}get lengthSq(){const{x:t,y:s,z:e,w:i}=this;return t*t+s*s+e*e+i*i}clone(){return new Et(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this}divScalar(t){return this.x/=t,this.y/=t,this.z/=t,this.w/=t,this}fromArray(t){return this.x=t[0],this.y=t[1],this.z=t[2],this.w=t[3],this}set(t,s,e,i){return this.x=t,this.y=s,this.z=e,this.w=i,this}unitize(){return this.divScalar(this.length||1)}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}const St={createCanvasElement:()=>{const u=globalThis.document.createElement("canvas");return u.style.display="block",u.style.imageRendering="pixelated",u},createCanvasRenderingContext2D:(u,t)=>u.getContext("2d",t)??(()=>{throw new Error("EASEL.CanvasUtils: 2D context not supported")})()};class Vt{}const jt=new p,ys=new p,ps=new p,fs=new p,D=new p,J=new p;class Gt extends Vt{frustum=new ht;#t=void 0;get camera(){return this.#t}clipLine(t,s){const a=this.#a(t,0,1,2,4,8,16,32),l=this.#a(s,0,1,2,4,8,16,32);if((a|l)===0)return[t.clone(),s.clone()];if((a&l)===0)return this.#e(t,s)}clipTriangle(t,s,e){return this.#c(t,s,e)?[[t.clone(),s.clone(),e.clone()]]:this.#o([[t.clone(),s.clone(),e.clone()]])}isBackFace(t,s,e){return this.#t?(Z.calculateNormal(t,s,e,jt),jt.dot(t)<0):!1}isFrontFace(t,s,e){return!this.isBackFace(t,s,e)}isPointVisible(t){return this.frustum.containsPoint(t)}reset(){return this.#t=void 0,this}setFromCamera(t){return this.#t=t,this.frustum.setFromProjectionMatrix(t.projectionMatrix),this}shouldCull(t,s,e,i){if(i.wireframe)return!1;const n=this.isBackFace(t,s,e);switch(i.side){case nt.front:return n;case nt.back:return!n;case nt.double:return!1;default:return n}}#s(t,s,e,i,n){const o=t.normal.dot(s),h=t.distanceToPoint(e);if(o===0)return h>=0;const c=-h/o;let a=i,l=n;return o<0?c>a&&(a=c):c<l&&(l=c),a<=l}#e(t,s){const e=fs.subVectors(s,t);let i=0,n=1;if(!this.#i(e,t,i,n))return;i=f.fastMax(0,i),n=f.fastMin(1,n);const r=ys.copy(t).add(D.copy(e).mulScalar(i)),o=ps.copy(t).add(J.copy(e).mulScalar(n));return[r.clone(),o.clone()]}#i(t,s,e,i){for(let n=0;n<6;n++){const r=this.frustum.planes[n];if(!r)throw new Error(`Easel.FrustumProcessor: invalid plane at index ${n}`);if(!this.#s(r,t,s,e,i))return!1}return!0}#n(t,s,e,i,n,r,o){const[h,c,a]=this.#p(t),[l,y,d]=this.#u(h,c,a,n,r),[w,g,m]=this.#l(s,e,i,n,r),x=w/(w-g),E=w/(w-m);D.copy(l).lerp(y,x),J.copy(l).lerp(d,E),o.push([D.clone(),y.clone(),d.clone()],[D.clone(),d.clone(),J.clone()])}#o(t){let s=t;for(let e=0;e<6;e++){const i=this.frustum.planes[e];if(!i)throw new Error(`Easel.FrustumProcessor: invalid plane at index ${e}`);if(s=this.#r(s,i),s.length===0)break}return s}#r(t,s){const e=[];for(const i of t)this.#x(i,s,e);return e}#h(t,s,e,i,n,r,o){const[h,c,a]=this.#p(t),[l,y,d]=this.#d(h,c,a,n,r),[w,g,m]=this.#y(s,e,i,n,r),x=m/(m-w),E=m/(m-g);D.copy(d).lerp(l,x),J.copy(d).lerp(y,E),o.push([d.clone(),D.clone(),J.clone()])}#a(t,s,e,i,n,r,o,h){let c=s;for(let a=0;a<6;a++){const l=this.frustum.planes[a];if(!l)throw new Error(`Easel.FrustumProcessor: invalid plane at index ${a}`);l.distanceToPoint(t)<0&&(c|=this.#f(a,e,i,n,r,o,h))}return c}#c(t,s,e){return this.frustum.containsPoint(t)&&this.frustum.containsPoint(s)&&this.frustum.containsPoint(e)}#l(t,s,e,i,n){return[i?t:n?s:e,i?s:n?e:t,i?e:n?t:s]}#u(t,s,e,i,n){return[i?t:n?s:e,i?s:n?e:t,i?e:n?t:s]}#d(t,s,e,i,n){return[i?n?t:e:s,i?n?s:t:e,i?n?e:s:t]}#y(t,s,e,i,n){return[i?n?t:e:s,i?n?s:t:e,i?n?e:s:t]}#f(t,s,e,i,n,r,o){switch(t){case 0:return s;case 1:return e;case 2:return i;case 3:return n;case 4:return r;case 5:return o;default:throw new Error(`Easel.FrustumProcessor: invalid plane index: ${t}`)}}#x(t,s,e){const[i,n,r]=t;if(!(i&&n&&r))throw new Error("Easel.FrustumProcessor: invalid triangle");const o=s.distanceToPoint(i),h=s.distanceToPoint(n),c=s.distanceToPoint(r),a=o<0,l=h<0,y=c<0;switch((a?1:0)+(l?1:0)+(y?1:0)){case 0:e.push(t);break;case 1:this.#n(t,o,h,c,a,l,e);break;case 2:this.#h(t,o,h,c,a,l,e);break}}#p(t){const[s,e,i]=t;if(!(s&&e&&i))throw new Error("Easel.FrustumProcessor: invalid triangle");return[s,e,i]}}class Yt{objects=[];add(t){return this.objects.includes(t)?this:(this.objects.push(t),this)}clear(){return this.objects.length=0,this}remove(t){const s=this.objects.indexOf(t);return s!==-1?(this.objects.splice(s,1),this):this}}class Dt{renderList=new Yt;populate(t,s){return this.renderList.clear(),this.#t(t),this}#t(t){this.renderList.add(t);for(const s of t.children)s.visible&&this.#t(s)}}const Ut=new p,_t=new p,$t=new p,At=new p,Pt=new p,vt=new p;class Wt extends Dt{#t=new Gt;width;height;constructor(t,s){super(),this.width=t??globalThis.innerWidth,this.height=s??globalThis.innerHeight}render(t,s,e){s.updateMatrixWorld(),this.#t.setFromCamera(s),this.populate(t,s);for(const i of this.renderList.objects)i instanceof H&&(i.updateWorldMatrix(!0,!1),this.#e(i,s,e));return this}setSize(t,s){return this.width=t,this.height=s,this}#s(t,s,e,i,n,r,o){const h=t[s],c=t[s+1],a=t[s+2];if(h>=e.length||c>=e.length||a>=e.length)return;const l=e[h],y=e[c],d=e[a];if(!(l&&y&&d)||(Ut.copy(l).applyMatrix4(i.worldMatrix),_t.copy(y).applyMatrix4(i.worldMatrix),$t.copy(d).applyMatrix4(i.worldMatrix),At.copy(Ut).applyMatrix4(n.matrixWorldInverse),Pt.copy(_t).applyMatrix4(n.matrixWorldInverse),vt.copy($t).applyMatrix4(n.matrixWorldInverse),this.#t.shouldCull(At,Pt,vt,o)))return;const w=this.#t.clipTriangle(At,Pt,vt);if(w.length!==0)for(const g of w)r.rasterize(g,n,o)}#e(t,s,e){const i=t.shape,n=t.material;if(!i?.vertices||i.vertices.length===0)return;const r=i.vertices;let o=i.indices;(!o||o.length===0)&&(o=Z.triangulate(r),i.indices=o);for(let h=0;h<o.length;h+=3)this.#s(o,h,r,t,s,e,n)}}class Xt{width;height;alpha;get aspect(){return this.width/this.height}constructor(t={}){this.width=t.width??globalThis.innerWidth,this.height=t.height??globalThis.innerHeight,this.alpha=t.alpha??!1}render(t,s){if(s instanceof et){const e=this.aspect;s.aspect!==e&&(s.aspect=e,s.updateProjectionMatrix())}return s.updateMatrixWorld(),this}}const Bt=new p,Ht=new p,Zt=new p,Tt=new p,j=new p,G=new p,Qt=new p;class Ft extends Xt{context;imageData;data;pipeline;#t;#s=new b(0,0,0);static#e(t,s,e){return s*e+t<<2}get domElement(){return this.#t}constructor(t={}){super(t),this.#t=St.createCanvasElement(),this.#t.width=this.width,this.#t.height=this.height,this.context=St.createCanvasRenderingContext2D(this.#t,{willReadFrequently:!0}),this.context.imageSmoothingEnabled=!1,this.imageData=this.context.createImageData(this.width,this.height),this.data=this.imageData.data,this.pipeline=new Wt(this.width,this.height)}beginFrame(){return this.data=this.imageData.data,this}clear(t){for(let s=0;s<this.height;s++)for(let e=0;e<this.width;e++)this.setPixel(e,s,t);return this}drawLine(t,s,e){this.#h(t,j),this.#h(s,G);const i=Math.abs(G.x-j.x),n=Math.abs(G.y-j.y);if(i<1&&n<1)return this;let r=j.x,o=j.y;const h=G.x,c=G.y,a=r<h?1:-1,l=o<c?1:-1;let y=i-n;for(;r>=0&&r<this.width&&o>=0&&o<this.height&&this.setPixel(r,o,e),!(r===h&&o===c);){const d=y<<1;d>-n&&(y-=n,r+=a),d<i&&(y+=i,o+=l)}return this}drawTriangle(t,s,e,i,n=!1){return n?(this.drawLine(t,s,i),this.drawLine(s,e,i),this.drawLine(e,t,i)):this.drawTriangleFilled(t,s,e,i),this}drawTriangleFilled(t,s,e,i){this.#h(t,j),this.#h(s,G),this.#h(e,Qt);const[n,r,o]=this.#c(j,G,Qt);return n.y===r.y?this.#o(n,r,o,i):r.y===o.y?this.#n(n,r,o,i):(()=>{const h=n.x+(r.y-n.y)/(o.y-n.y)*(o.x-n.x);Tt.set(h,r.y,0),this.#n(n,r,Tt,i),this.#o(r,Tt,o,i)})(),this}endFrame(){return this.context.putImageData(this.imageData,0,0),this}rasterize(t,s,e){if(t.length===3){const i=t[0],n=t[1],r=t[2];i&&n&&r&&(Bt.copy(i).applyMatrix4(s.projectionMatrix),Ht.copy(n).applyMatrix4(s.projectionMatrix),Zt.copy(r).applyMatrix4(s.projectionMatrix),this.drawTriangle(Bt,Ht,Zt,e.color,e.wireframe))}}setClearColor(t){return t instanceof b?this.#s.copy(t):this.#s.parse(t),this}setPixel(t,s,e){const i=Ft.#e(t,s,this.width);return this.#a(i,e),this}setSize(t,s){return this.width=t,this.height=s,this.#t.style.width=`${t}px`,this.#t.style.height=`${s}px`,this.#t.width=t,this.#t.height=s,this.context.imageSmoothingEnabled=!1,this.imageData=this.context.createImageData(t,s),this.data=this.imageData.data,this.pipeline.setSize(t,s),this}#i(t,s,e,i,n){const{x:r,y:o}=t,{x:h,y:c}=s,{x:a,y:l}=e,y=n?(a-r)/(l-o):(h-r)/(c-o),d=n?(a-h)/(l-c):(a-r)/(l-o),w=f.clamp(Math.ceil(o),0,this.height-1),g=f.clamp(f.fastTrunc(n?l:c),0,this.height-1);for(let m=w;m<=g;m++){const x=r+(m-o)*y,E=n?h+(m-c)*d:r+(m-o)*d;this.#r(m,x,E,i)}}#n(t,s,e,i){this.#i(t,s,e,i,!1)}#o(t,s,e,i){this.#i(t,s,e,i,!0)}#r(t,s,e,i){const n=f.clamp(Math.ceil(f.fastMin(s,e)),0,this.width-1),r=f.clamp(f.fastTrunc(f.fastMax(s,e)),0,this.width-1);for(let o=n;o<=r;o++)this.setPixel(o,t,i)}#h(t,s=new p){const e=f.fastTrunc((t.x+1)*this.width>>1),i=f.fastTrunc((1-t.y)*this.height>>1),n=f.clamp(e,0,this.width-1),r=f.clamp(i,0,this.height-1);return s.set(n,r,t.z)}#a(t,s){const e=b.toRgb(s);this.data[t]=e.r,this.data[t+1]=e.g,this.data[t+2]=e.b,this.data[t+3]=b.RGB_SCALE}#c(t,s,e){let i=t.clone(),n=s.clone(),r=e.clone();return i.y>n.y&&([i,n]=[n,i]),i.y>r.y&&([i,r]=[r,i]),n.y>r.y&&([n,r]=[r,n]),[i,n,r]}render(t,s){return super.render(t,s),this.beginFrame(),this.clear(this.#s),this.pipeline.render(t,s,this),this.endFrame(),this}}class xs extends q{background=new b(0);constructor(){super(),this.name="Scene"}clear(){for(const t of[...this.children])this.remove(t);return this}copy(t){return super.copy(t),t.background!==void 0&&(this.background=t.background),this}}class Lt extends Y{constructor(t=1,s=1,e=1){super();const i=t/2,n=s/2,r=e/2;this.vertices=[new p(-i,-n,-r),new p(i,-n,-r),new p(i,n,-r),new p(-i,n,-r),new p(-i,-n,r),new p(i,-n,r),new p(i,n,r),new p(-i,n,r)],this.indices=new Uint16Array([0,1,2,2,3,0,5,4,7,7,6,5,1,5,6,6,2,1,4,0,3,3,7,4,3,2,6,6,7,3,1,0,4,4,5,1])}clone(){return new Lt().copy(this)}}class Nt extends Y{constructor(t=1,s=1,e=1,i=1){super();const n=Math.floor(e),r=Math.floor(i),o=n+1,h=r+1,c=t/n,a=s/r,l=t/2,y=s/2;this.vertices=Array.from({length:o*h},(d,w)=>{const g=w%o,m=Math.floor(w/o);return new p(g*c-l,m*a-y,0)}),this.indices=new Uint16Array(n*r*6);for(let d=0;d<this.indices.length;d++){const w=Math.floor(d/6),g=w%n,m=Math.floor(w/n),x=g+o*m,E=g+o*(m+1),A=g+1+o*(m+1),S=g+1+o*m;this.indices[d]=Number([x,E,S,E,A,S][d%6])}}clone(){return new Nt().copy(this)}}typeof window<"u"&&(window.__easel__?console.warn("multiple instances of Easel.js in same page"):window.__easel__=W),z.Box3=zt,z.Camera=B,z.CanvasRenderer=Ft,z.CanvasUtils=St,z.Clock=ts,z.Color=b,z.CubeShape=Lt,z.DirectionalLight=wt,z.Euler=X,z.Frustum=ht,z.FrustumProcessor=Gt,z.Light=it,z.Line3=bt,z.Material=rt,z.MathUtils=f,z.Matrix3=Q,z.Matrix4=R,z.Mesh=H,z.ObjLoader=ds,z.Object3D=q,z.OrthoCamera=mt,z.PerspCamera=et,z.Pipeline=Dt,z.Plane=T,z.PlaneShape=Nt,z.Processor=Vt,z.Quaternion=k,z.RenderList=Yt,z.RenderPipeline=Wt,z.Renderer=Xt,z.Scene=xs,z.Shape=Y,z.ShapeUtils=Z,z.Sphere=Mt,z.Vector2=ot,z.Vector3=p,z.Vector4=Et,Object.defineProperty(z,Symbol.toStringTag,{value:"Module"})});
